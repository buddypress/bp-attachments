!function(){function e(e){return e&&e.__esModule?e.default:e}var t;t=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"version":"1.0.0","name":"bp/file-attachment","title":"File","category":"community-media","icon":"media-text","description":"Insert a file from your personal media library.","keywords":["BuddyPress","community","file","media"],"textdomain":"bp-attachments","attributes":{"align":{"type":"string"},"url":{"type":"string"},"name":{"type":"string"},"mediaType":{"type":"string"}},"supports":{"alignWide":false,"anchor":false,"html":false},"editorScript":"file:./bp-attachments/assets/blocks/file-attachment/js/index.js","style":"file:./bp-attachments/assets/blocks/file-attachment/css/index.css"}');const{apiFetch:a,components:{DropZone:n,FormFileUpload:i,Notice:s,Placeholder:l},data:{useSelect:o},element:{createElement:c,useState:r},i18n:{__:m}}=wp;var p=e=>{let{type:t,icon:p,label:d,onSetAttributes:u}=e;const{bpAttachments:{allowedExtByMediaList:b,allowedExtTypes:h,mimeTypeImageBaseUrl:g}}=o((e=>e("core/editor").getEditorSettings()),[]),y=b[t+"_playlist"]?b[t+"_playlist"]:b.album,f="any"===t?h:y,[k,_]=r(""),{userId:v,postId:w}=o((e=>({userId:e("core").getCurrentUser().id,postId:e("core/editor").getCurrentPostId()})),[]),T=e=>{let n;n=e.currentTarget&&e.currentTarget.files?[...e.currentTarget.files]:e;(e=>{const n=new FormData;n.append("file",e),n.append("action","bp_attachments_media_upload"),n.append("object","members"),n.append("object_item",v),n.append("visibility","public"),w&&(n.append("attached_to_object_type","post"),n.append("attached_to_object_id",w)),_(""),a({path:"buddypress/v1/attachments",method:"POST",body:n}).then((e=>{e.links&&e.links.src&&u("any"===t?{url:e.links.view,name:e.title,mediaType:e.icon.replace(g,"").replace(".png","")}:{url:e.links.view,src:e.links.src})})).catch((e=>{if(e.message){const t=c(s,{status:"error",isDismissible:!1},c("p",null,e.message));_(t)}}))})(n[0])};return c(l,{icon:p||"admin-media",label:d||m("Community Media","bp-attachments"),isColumnLayout:!0,className:"bp-attachments-media-placeholder"},c(n,{onFilesDrop:e=>T(e),className:"uploader-inline"}),c(i,{onChange:e=>T(e),multiple:!1,accept:f,className:"components-button block-editor-media-placeholder__button block-editor-media-placeholder__upload-button is-primary"},m("Select a file","bp-attachments")),k)};const{blockEditor:{BlockAlignmentControl:d,BlockControls:u,useBlockProps:b,RichText:h},data:{useSelect:g},element:{createElement:y,Fragment:f},i18n:{__:k}}=wp;var _=e=>{let{attributes:t,setAttributes:a}=e;const{bpAttachments:{mimeTypeImageBaseUrl:n}}=g((e=>e("core/editor").getEditorSettings()),[]),{align:i,name:s,url:l,mediaType:o}=t,c=b({className:i&&void 0!==i?"wp-block-bp-file-attachment align"+i:"wp-block-bp-file-attachment"});return l?y(f,null,y(u,{group:"block"},y(d,{controls:["none","left","center","right"],value:i,onChange:e=>a({align:e})})),y("div",c,y("div",{className:"bp-attachment-file-icon"},y("img",{src:n+o+".png"})),y("div",{className:"bp-attachment-file-content"},y("div",{className:"bp-attachment-file-title"},y(h,{tagName:"a",value:s,placeholder:k("Write file nameâ€¦","bp-attachments"),withoutInteractiveFormatting:!0,onChange:e=>a({name:e}),href:l})),y("div",{className:"wp-element-button bp-attachments-button"},k("Download","bp-attachments"))))):y("figure",c,y(p,{type:"any",icon:"media-text",label:k("Community File","bp-attachments"),onSetAttributes:a}))};const{blocks:{registerBlockType:v},element:{createElement:w}}=wp;v(e(t),{icon:{background:"#fff",foreground:"#d84800",src:"media-text"},edit:_})}();
//# sourceMappingURL=index.js.map
