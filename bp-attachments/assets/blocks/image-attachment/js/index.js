!function(){function e(e){return e&&e.__esModule?e.default:e}var t;t=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"version":"1.0.0","name":"bp/image-attachment","title":"Picture","category":"community-media","icon":"format-image","description":"Insert a picture from your personal media library.","keywords":["BuddyPress","community","image","img","picture","photo","media"],"textdomain":"bp-attachments","attributes":{"align":{"type":"string"},"url":{"type":"string"},"src":{"type":"string"}},"supports":{"alignWide":false,"anchor":false,"html":false},"editorScript":"file:./bp-attachments/assets/blocks/image-attachment/js/index.js","style":"file:./bp-attachments/assets/blocks/image-attachment/css/index.css"}');const{apiFetch:a,components:{DropZone:n,FormFileUpload:i,Notice:s,Placeholder:o},data:{useSelect:r},element:{createElement:l,useState:c},i18n:{__:m}}=wp;var p=e=>{let{type:t,icon:p,label:d,onSetAttributes:u}=e;const{bpAttachments:{allowedExtByMediaList:b,allowedExtTypes:g,mimeTypeImageBaseUrl:h}}=r((e=>e("core/editor").getEditorSettings()),[]),y=b[t+"_playlist"]?b[t+"_playlist"]:b.album,f="any"===t?g:y,[k,_]=c(""),{userId:w,postId:v}=r((e=>({userId:e("core").getCurrentUser().id,postId:e("core/editor").getCurrentPostId()})),[]),C=e=>{let n;n=e.currentTarget&&e.currentTarget.files?[...e.currentTarget.files]:e;(e=>{const n=new FormData;n.append("file",e),n.append("action","bp_attachments_media_upload"),n.append("object","members"),n.append("object_item",w),n.append("visibility","public"),v&&(n.append("attached_to_object_type","post"),n.append("attached_to_object_id",v)),_(""),a({path:"buddypress/v1/attachments",method:"POST",body:n}).then((e=>{e.links&&e.links.src&&u("any"===t?{url:e.links.view,name:e.title,mediaType:e.icon.replace(h,"").replace(".png","")}:{url:e.links.view,src:e.links.src})})).catch((e=>{if(e.message){const t=l(s,{status:"error",isDismissible:!1},l("p",null,e.message));_(t)}}))})(n[0])};return l(o,{icon:p||"admin-media",label:d||m("Community Media","bp-attachments"),isColumnLayout:!0,className:"bp-attachments-media-placeholder"},l(n,{onFilesDrop:e=>C(e),className:"uploader-inline"}),l(i,{onChange:e=>C(e),multiple:!1,accept:f,className:"components-button block-editor-media-placeholder__button block-editor-media-placeholder__upload-button is-primary"},m("Select a file","bp-attachments")),k)};const{blockEditor:{BlockAlignmentControl:d,BlockControls:u,useBlockProps:b},element:{createElement:g,Fragment:h},i18n:{__:y}}=wp;var f=e=>{let{attributes:t,setAttributes:a}=e;const{align:n,src:i}=t,s=b({className:n&&void 0!==n?"wp-block-bp-image-attachment align"+n:"wp-block-bp-image-attachment"});return i?g(h,null,g(u,{group:"block"},g(d,{controls:["none","left","center","right"],value:n,onChange:e=>a({align:e})})),g("figure",s,g("img",{src:i}))):g("figure",s,g(p,{type:"image",icon:"format-image",label:y("Community Image","bp-attachments"),onSetAttributes:a}))};const{blocks:{registerBlockType:k},element:{createElement:_}}=wp;k(e(t),{icon:{background:"#fff",foreground:"#d84800",src:"format-image"},edit:f})}();
//# sourceMappingURL=index.js.map
