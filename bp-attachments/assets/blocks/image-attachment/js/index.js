!function(){function e(e){return e&&e.__esModule?e.default:e}var t;t=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"bp/image-attachment","title":"Community Image","category":"media","icon":"image","description":"Insert an image from your personal media library.","keywords":["BuddyPress","community","image","img","picture","photo","media"],"textdomain":"bp-attachments","attributes":{"align":{"type":"string"},"url":{"type":"string"},"src":{"type":"string"}},"supports":{"alignWide":false,"anchor":false,"html":false},"editorScript":"file:./bp-attachments/js/blocks/image-attachment/index.js","style":"file:./bp-attachments/assets/blocks/image-attachment/index.css"}');const{components:{DropZone:a,FormFileUpload:n,Placeholder:s},data:{useDispatch:o,useSelect:i},element:{createElement:r},i18n:{__:c}}=wp;var l=e=>{let{type:t,icon:o,label:l,onUploadedMedium:m,children:p}=e;const{bpAttachments:{allowedExtByMediaList:d}}=i((e=>e("core/editor").getEditorSettings()),[]),u=d[t+"_playlist"]?d[t+"_playlist"]:d.album,g=e=>{let t;t=e.currentTarget&&e.currentTarget.files?[...e.currentTarget.files]:e;const a=t[0];m(a)};return r(s,{icon:o||"admin-media",label:l||c("Community Media","bp-attachments"),isColumnLayout:!0},r(a,{onFilesDrop:e=>g(e),className:"uploader-inline"}),r(n,{onChange:e=>g(e),multiple:!1,accept:u,className:"components-button block-editor-media-placeholder__button block-editor-media-placeholder__upload-button is-primary"},c("Select a file","bp-attachments")),p)};const{apiFetch:m,blockEditor:{BlockAlignmentControl:p,BlockControls:d,useBlockProps:u},data:{useSelect:g},components:{Notice:b},element:{createElement:h,Fragment:y,useState:k},i18n:{__:_}}=wp;var f=e=>{let{attributes:t,setAttributes:a}=e;const{align:n,src:s}=t,o=u({className:n&&void 0!==n?"wp-block-bp-image-attachment align"+n:"wp-block-bp-image-attachment"}),[i,r]=k(""),{userId:c,postId:f}=g((e=>({userId:e("core").getCurrentUser().id,postId:e("core/editor").getCurrentPostId()})),[]);return s?h(y,null,h(d,{group:"block"},h(p,{controls:["none","left","center","right"],value:n,onChange:e=>a({align:e})})),h("figure",o,h("img",{src:s}))):h(l,{type:"image",icon:"format-image",label:_("Community Image","bp-attachments"),onUploadedMedium:e=>{const t=new FormData;t.append("file",e),t.append("action","bp_attachments_media_upload"),t.append("object","members"),t.append("object_item",c),t.append("status","public"),f&&(t.append("attached_to_object_type","post"),t.append("attached_to_object_id",f)),r(""),m({path:"buddypress/v1/attachments",method:"POST",body:t}).then((e=>{e.links&&e.links.src&&a({url:e.links.view,src:e.links.src})})).catch((e=>{if(e.message){const t=h(b,{status:"error",isDismissible:!1},h("p",null,e.message));r(t)}}))}},i)};const{blocks:{registerBlockType:w},blockEditor:{useBlockProps:C},element:{createElement:I},i18n:{__:B}}=wp;w(e(t),{title:B("Community Image","bp-attachments"),description:B("Insert an image into your personal media library and use it for this content.","bp-attachments"),icon:{background:"#fff",foreground:"#d84800",src:"format-image"},category:"media",keywords:["BuddyPress",B("community","bp-attachments"),B("image","bp-attachments"),B("img","bp-attachments"),B("picture","bp-attachments"),B("photo","bp-attachments"),B("media","bp-attachments")],attributes:{align:{type:"string"},url:{type:"string"},src:{type:"string"}},supports:{alignWide:!1,anchor:!1,html:!1},edit:f})}();
//# sourceMappingURL=index.js.map
