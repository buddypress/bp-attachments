!function(){function e(e){return e&&e.__esModule?e.default:e}var t;t=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"bp/image-attachment","title":"Community Image","category":"media","icon":"image","description":"Insert an image from your personal media library.","keywords":["BuddyPress","community","image","img","picture","photo","media"],"textdomain":"bp-attachments","attributes":{"align":{"type":"string"},"url":{"type":"string"},"src":{"type":"string"}},"supports":{"alignWide":false,"anchor":false,"html":false},"editorScript":"file:./bp-attachments/js/blocks/image-attachment/index.js","style":"file:./bp-attachments/assets/blocks/image-attachment/index.css"}');const{components:{DropZone:a,FormFileUpload:s,Placeholder:n},data:{useDispatch:i,useSelect:o},element:{createElement:r},i18n:{__:c}}=wp;var m=e=>{let{type:t,icon:i,label:m,onUploadedMedium:l,children:p}=e;const{bpAttachments:{allowedExtByMediaList:d}}=o((e=>e("core/editor").getEditorSettings()),[]),u=d[t+"_playlist"]?d[t+"_playlist"]:d.album,b=e=>{let t;t=e.currentTarget&&e.currentTarget.files?[...e.currentTarget.files]:e;const a=t[0];l(a)};return r(n,{icon:i||"admin-media",label:m||c("Community Media","bp-attachments"),isColumnLayout:!0},r(a,{onFilesDrop:e=>b(e),className:"uploader-inline"}),r(s,{onChange:e=>b(e),multiple:!1,accept:u,className:"components-button block-editor-media-placeholder__button block-editor-media-placeholder__upload-button is-primary"},c("Select a file","bp-attachments")),p)};const{apiFetch:l,blockEditor:{useBlockProps:p},data:{useSelect:d},components:{Notice:u},element:{createElement:b,useState:g},i18n:{__:h}}=wp;var y=e=>{let{attributes:t,setAttributes:a}=e;const s=p({className:"wp-block-bp-image-attachment"}),[n,i]=g(""),{align:o,url:r,src:c}=t,{userId:y,postId:_}=d((e=>({userId:e("core").getCurrentUser().id,postId:e("core/editor").getCurrentPostId()})),[]);return c?b("figure",s,b("img",{src:c})):b(m,{type:"image",icon:"format-image",label:h("Community Image","bp-attachments"),onUploadedMedium:e=>{const t=new FormData;t.append("file",e),t.append("action","bp_attachments_media_upload"),t.append("object","members"),t.append("object_item",y),t.append("status","public"),_&&(t.append("attached_to_object_type","post"),t.append("attached_to_object_id",_)),i(""),l({path:"buddypress/v1/attachments",method:"POST",body:t}).then((e=>{e.links&&e.links.src&&a({url:e.links.view,src:e.links.src})})).catch((e=>{if(e.message){const t=b(u,{status:"error",isDismissible:!1},b("p",null,e.message));i(t)}}))}},n)};const{blocks:{registerBlockType:_},blockEditor:{useBlockProps:f},element:{createElement:k},i18n:{__:w}}=wp;_(e(t),{title:w("Community Image","bp-attachments"),description:w("Insert an image into your personal media library and use it for this content.","bp-attachments"),icon:{background:"#fff",foreground:"#d84800",src:"format-image"},category:"media",keywords:["BuddyPress",w("community","bp-attachments"),w("image","bp-attachments"),w("img","bp-attachments"),w("picture","bp-attachments"),w("photo","bp-attachments"),w("media","bp-attachments")],attributes:{align:{type:"string"},url:{type:"string"},src:{type:"string"}},supports:{alignWide:!1,anchor:!1,html:!1},edit:y})}();
//# sourceMappingURL=index.js.map
