{"mappings":"YAGA,MAAMA,SAAEA,GAAaC,OCArB,MAAMC,SACLC,GACGC,GAsGJC,OAAOC,GAAKD,OAAOC,IAAM,GACzBD,OAAOC,GAAGC,YAAcF,OAAOC,GAAGC,aAAe,GAEjD,MAAMC,EAAgBH,OAAOI,oBAAsB,GACnDJ,OAAOC,GAAGC,YAAYG,SAAW,IAnGjC,MAqBCC,UAAWC,GACVA,EAAMC,iBACNC,KAAKC,OAAOC,QAEGJ,EAAMK,OAAOC,QAAS,uBAC9BC,cAAe,wBAAyBC,UAAUC,OAAQ,uBACjET,EAAMK,OAAOG,UAAUE,IAAK,uBAE5B,MAAMC,EAAaX,EAAMK,OAAOC,QAAS,wBAAyBM,aAAc,QAChFV,KAAKC,OAAOU,aAAc,MAAOF,GACjCT,KAAKC,OAAOW,M,CAWbC,WAAYC,GDjDb,IAAsBC,ECmDpB,ODnDoBA,ECkDU,mBD1CxB7B,EAAU8B,SAASX,cAAe,SAAWU,GAAOE,UAP3C,CACfC,SAAQ,kBACRC,YAAW,0BACXC,OAAM,2BACNC,SAAa,UC8CIP,E,CAQlBQ,cACC,IAAIC,EAAY,EAChB,MAAMC,EAAYR,SAASX,cAAe,2DAE1CL,KAAKyB,MAAMC,SAAWC,IACrBJ,GAAa,EAEb,MAAMK,EAAO,CACZC,MAAON,EACPO,IAAKH,EAAKI,MAAMD,IAChBE,MAAOL,EAAKK,MACZC,KAAM,IAGPT,EAAUP,WAAajB,KAAKa,WAAYe,EAAM,IAG/CJ,EAAUU,iBAAkB,qBAAsBR,SAAS,CAAES,EAASC,KAChE,IAAMA,GACVD,EAAQ7B,UAAUE,IAAK,uBAGxB2B,EAAQE,iBAAkB,QAASrC,KAAKH,UAAUyC,KAAMtC,MAAQ,G,CASjEuC,QACA,IAAOvC,KAAKyB,QAAWzB,KAAKyB,MAAMe,OACjC,OAGD,MAAMC,EAAazC,KAAKyB,MAAM,GAAGM,MAAMD,IACvC9B,KAAKC,OAAOU,aAAc,MAAO8B,GAEjCzC,KAAKsB,a,CAnFNoB,YAAajB,GACZ,MAAMkB,KAAEA,GAASlB,EACjBzB,KAAKyB,MAAQkB,EACb3C,KAAKC,OAASe,SAASX,cAAe,oB,GAwFoBX,GAE5DL,GAAU,IAAME,OAAOC,GAAGC,YAAYG,SAAS2C,S","sources":["src/media-library/utils/set-template.js","src/front-end/playlist.js"],"sourcesContent":["/**\n * External dependencies\n */\nconst { template } = lodash;\n\nfunction setTemplate( tmpl ) {\n\tconst options = {\n\t\tevaluate:    /<#([\\s\\S]+?)#>/g,\n\t\tinterpolate: /\\{\\{\\{([\\s\\S]+?)\\}\\}\\}/g,\n\t\tescape:      /\\{\\{([^\\}]+?)\\}\\}(?!\\})/g,\n\t\tvariable:    'data'\n\t};\n\n\treturn template( document.querySelector( '#tmpl-' + tmpl ).innerHTML, options );\n}\n\nexport default setTemplate;\n","/**\n * WordPress dependencies\n */\nconst {\n\tdomReady,\n} = wp;\n\n/**\n * Internal dependencies.\n */\nimport setTemplate from '../media-library/utils/set-template';\n\nclass bpAttachmentsPlaylist {\n\t/**\n\t * Setup the Playlist.\n\t *\n\t * @since 1.0.0\n\t *\n\t * @param {Object} items The preloaded playlist items.\n\t */\n\tconstructor( items ) {\n\t\tconst { body } = items;\n\t\tthis.items = body;\n\t\tthis.player = document.querySelector( '#bp-medium-player' );\n\t}\n\n\t/**\n\t * Plays the medium according to the clicked link.\n\t *\n\t * @since 1.0.0\n\t *\n\t * @param {PointerEvent} event The event.\n\t */\n\tplayTrack( event ) {\n\t\tevent.preventDefault();\n\t\tthis.player.pause();\n\n\t\tconst parent = event.target.closest( '.wp-playlist-tracks' );\n\t\tparent.querySelector( '.wp-playlist-playing' ).classList.remove( 'wp-playlist-playing' );\n\t\tevent.target.classList.add( 'wp-playlist-playing' );\n\n\t\tconst currentSrc = event.target.closest( '.wp-playlist-caption' ).getAttribute( 'href' );\n\t\tthis.player.setAttribute( 'src', currentSrc );\n\t\tthis.player.play();\n\t}\n\n\t/**\n\t * Renders the HTML of a medium.\n\t *\n\t * @since 1.0.0\n\t *\n\t * @param {Object} props The medium properties.\n\t * @returns {string} HTML output.\n\t */\n\trenderItem( props ) {\n\t\tconst Template = setTemplate( 'wp-playlist-item' );\n\t\treturn Template( props );\n\t}\n\n\t/**\n\t * Renders Media links.\n\t *\n\t * @since 1.0.0\n\t */\n\trenderItems() {\n\t\tlet itemIndex = 0;\n\t\tconst container = document.querySelector( '.bp-attachments-medium .wp-playlist .wp-playlist-tracks' );\n\n\t\tthis.items.forEach( ( item ) => {\n\t\t\titemIndex += 1;\n\n\t\t\tconst data = {\n\t\t\t\tindex: itemIndex,\n\t\t\t\tsrc: item.links.src,\n\t\t\t\ttitle: item.title,\n\t\t\t\tmeta: {},\n\t\t\t};\n\n\t\t\tcontainer.innerHTML += this.renderItem( data );\n\t\t} );\n\n\t\tcontainer.querySelectorAll( '.wp-playlist-item' ).forEach( ( element, elementIndex ) => {\n\t\t\tif ( 0 === elementIndex ) {\n\t\t\t\telement.classList.add( 'wp-playlist-playing' );\n\t\t\t}\n\n\t\t\telement.addEventListener( 'click', this.playTrack.bind( this ) );\n\t\t} );\n\t}\n\n\t/**\n\t * Init the playlist.\n\t *\n\t * @since 1.0.0\n\t */\n\t start() {\n\t\tif ( ! this.items || ! this.items.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst initialSrc = this.items[0].links.src;\n\t\tthis.player.setAttribute( 'src', initialSrc );\n\n\t\tthis.renderItems();\n\t }\n}\n\nwindow.bp = window.bp || {};\nwindow.bp.Attachments = window.bp.Attachments || {};\n\nconst playlistItems = window.bpAttachmentsItems || {};\nwindow.bp.Attachments.Playlist = new bpAttachmentsPlaylist( playlistItems );\n\ndomReady( () => window.bp.Attachments.Playlist.start() );\n"],"names":["template","lodash","domReady","$e83607f94be262f8$var$domReady","wp","window","bp","Attachments","$e83607f94be262f8$var$playlistItems","bpAttachmentsItems","Playlist","playTrack","event","preventDefault","this","player","pause","target","closest","querySelector","classList","remove","add","currentSrc","getAttribute","setAttribute","play","renderItem","props","tmpl","document","innerHTML","evaluate","interpolate","escape","variable","renderItems","itemIndex","container","items","forEach","item","data","index","src","links","title","meta","querySelectorAll","element","elementIndex","addEventListener","bind","start","length","initialSrc","constructor","body"],"version":3,"file":"playlist.js.map"}