!function(){function e(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}const t="bp/attachments";var r={};e(r,"getSettings",(function(){return m})),e(r,"getRequestsContext",(function(){return y})),e(r,"isGridDisplayMode",(function(){return h})),e(r,"getLoggedInUser",(function(){return b})),e(r,"getFormState",(function(){return E})),e(r,"isUploading",(function(){return f})),e(r,"uploadEnded",(function(){return g})),e(r,"getUploads",(function(){return _})),e(r,"getErrors",(function(){return D})),e(r,"getMedia",(function(){return v})),e(r,"getCurrentDirectory",(function(){return T})),e(r,"getCurrentDirectoryObject",(function(){return S})),e(r,"getTree",(function(){return M})),e(r,"getFlatTree",(function(){return R})),e(r,"isSelectable",(function(){return A})),e(r,"selectedMedia",(function(){return O})),e(r,"getRelativePath",(function(){return I})),e(r,"getDestinationData",(function(){return N}));const{i18n:{__:n}}=wp,{filter:a}=lodash,i=(e,t)=>{let r=a(e,{id:t});return r.forEach((t=>{const n=i(e,t.parent);r=[...r,...n]})),r},s=e=>{const t=[n("Bytes","bp-attachments"),n("KB","bp-attachments"),n("MB","bp-attachments"),n("GB","bp-attachments"),n("TB","bp-attachments")];if(0===e)return"0 "+t[0];const r=parseInt(Math.floor(Math.log(e)/Math.log(1024)),10);return 0===r?`${e} ${t[r]}`:`${(e/1024**r).toFixed(1)} ${t[r]}`},{trim:o,groupBy:c,filter:l,indexOf:d,find:u,defaultTo:p}=lodash,m=e=>{const{settings:t}=e;return t},y=e=>{const{settings:{isAdminScreen:t}}=e;return!0===t?"edit":"view"},h=e=>{const{isGrid:t}=e;return t},b=e=>{const{user:t}=e;return t},E=e=>{const{formState:t}=e;return t},f=e=>{const{uploading:t}=e;return t},g=e=>{const{ended:t}=e;return t},_=e=>{const{uploads:t}=e;return t},D=e=>{const{errors:t}=e;return t},v=e=>{const{files:t}=e;return t},T=e=>{const{currentDirectory:t}=e;return t||""},S=e=>{const{currentDirectory:t,tree:r}=e,n={readonly:!0};return""!==t?p(u(r,{id:t}),n):n},M=e=>{const{tree:t,currentDirectory:r}=e,n=c(t,"parent"),a=l(t,{parent:r||0}).map((e=>e.id));if(a&&a.length&&a.forEach((e=>{n[e]&&delete n[e]})),r){const e=i(t,r).map((e=>e.id));Object.keys(n).forEach((t=>{0!==parseInt(t,10)&&-1===d(e,t)&&delete n[t]}))}const s=e=>e.map((e=>{const t=n[e.id];return{...e,children:t&&t.length?s(t):[]}}));return s(n[0]||[])},R=e=>{const{tree:t}=e;return t||[]},A=e=>{const{isSelectable:t}=e;return t},O=e=>{const{files:t}=e;return l(t,["selected",!0])},I=e=>{const{relativePath:t}=e;return t},N=e=>{const{relativePath:t}=e;if(!t)return{object:"members"};const r=o(t,"/").split("/");return{status:r[0]?r[0]:"public",object:r[1]?r[1]:"members",item:r[2]?r[2]:""}};var w={};e(w,"setSettings",(function(){return B})),e(w,"fetchFromAPI",(function(){return H})),e(w,"createFromAPI",(function(){return q})),e(w,"deleteFromAPI",(function(){return V})),e(w,"switchDisplayMode",(function(){return $})),e(w,"getLoggedInUser",(function(){return W})),e(w,"getMedia",(function(){return Y})),e(w,"updateFormState",(function(){return z})),e(w,"initTree",(function(){return K})),e(w,"addItemTree",(function(){return Q})),e(w,"removeItemTree",(function(){return Z})),e(w,"toggleSelectable",(function(){return J})),e(w,"toggleMediaSelection",(function(){return ee})),e(w,"addMedium",(function(){return te})),e(w,"addMediumError",(function(){return re})),e(w,"createMedium",(function(){return ne})),e(w,"createDirectory",(function(){return ae})),e(w,"parseResponseMedia",(function(){return ie})),e(w,"requestMedia",(function(){return se})),e(w,"removeMedium",(function(){return oe})),e(w,"deleteMedium",(function(){return ce})),e(w,"removeMediumError",(function(){return le}));const L={SET_SETTINGS:"SET_SETTINGS",GET_LOGGED_IN_USER:"GET_LOGGED_IN_USER",GET_MEDIA:"GET_MEDIA",ADD_MEDIUM:"ADD_MEDIUM",FILL_TREE:"FILL_TREE",PURGE_TREE:"PURGE_TREE",REMOVE_MEDIUM:"REMOVE_MEDIUM",FETCH_FROM_API:"FETCH_FROM_API",CREATE_FROM_API:"CREATE_FROM_API",DELETE_FROM_API:"DELETE_FROM_API",UPLOAD_START:"UPLOAD_START",UPLOAD_END:"UPLOAD_END",RESET_UPLOADS:"RESET_UPLOADS",ADD_ERROR:"ADD_ERROR",REMOVE_ERROR:"REMOVE_ERROR",TOGGLE_SELECTABLE:"TOGGLE_SELECTABLE",TOGGLE_MEDIA_SELECTION:"TOGGLE_MEDIA_SELECTION",SWITCH_DISPLAY_MODE:"SWITCH_DISPLAY_MODE",UPDATE_FORM_STATE:"UPDATE_FORM_STATE"},{uniqueId:P,hasIn:C,trim:F,trimEnd:G,filter:U}=lodash,{data:{dispatch:j,select:x},url:{addQueryArgs:k}}=wp;function B(e){return{type:L.SET_SETTINGS,settings:e}}function H(e,t){return{type:L.FETCH_FROM_API,path:e,parse:t}}function q(e,t){return{type:L.CREATE_FROM_API,path:e,data:t}}function V(e,t){return{type:L.DELETE_FROM_API,path:e,relativePath:t}}function $(e){return{type:L.SWITCH_DISPLAY_MODE,isGrid:e}}function W(e){return{type:L.GET_LOGGED_IN_USER,user:e}}function Y(e,t,r){return{type:L.GET_MEDIA,files:e,relativePath:t,currentDirectory:r}}function z(e){return{type:L.UPDATE_FORM_STATE,params:e}}const X=(e,t)=>({id:e.id,slug:e.name,name:e.title,parent:t,object:e.object?e.object:"members",readonly:!!e.readonly&&e.readonly,visibility:e.visibility?e.visibility:"public",type:e.media_type?e.media_type:"folder"});function K(e){const r=x(t).getTree(),n=U(e,{mime_type:"inode/directory"});r.length||n.forEach((e=>{const r=X(e,0);j(t).addItemTree(r)}))}function Q(e){return{type:L.FILL_TREE,item:e}}function Z(e){return{type:L.PURGE_TREE,itemId:e}}function J(e){return{type:L.TOGGLE_SELECTABLE,isSelectable:e}}function ee(e,t){return{type:L.TOGGLE_MEDIA_SELECTION,ids:e,isSelected:t}}function te(e){return{type:L.ADD_MEDIUM,file:e}}function re(e){return{type:L.ADD_ERROR,error:e}}function*ne(e){let r,n=!0;const a=x(t),{object:i,item:s,status:o}=a.getDestinationData(),c=a.getRelativePath();yield{type:"UPLOAD_START",uploading:n,file:e};const l=new FormData;if(l.append("file",e),l.append("action","bp_attachments_media_upload"),l.append("object",i),l.append("object_item",s),o&&l.append("status",o),F(c,"/")!==o+"/"+i+"/"+s){let e=c;"private"===o&&(e=c.replace("/private","")),l.append("parent_dir",e)}n=!1;try{return r=yield q("/buddypress/v1/attachments",l),yield{type:"UPLOAD_END",uploading:n,file:e},te(r)}catch(t){return r={id:P(),name:e.name,error:t.message,uploaded:!1},yield{type:"UPLOAD_END",uploading:n,file:e},re(r)}}function*ae(e){let r,n=!0,a={name:e.directoryName,type:e.directoryType};const i=x(t),{object:s,item:o,status:c}=i.getDestinationData(),l=i.getRelativePath();yield{type:"UPLOAD_START",uploading:n,file:a};const d=new FormData;if(d.append("directory_name",a.name),d.append("directory_type",a.type),d.append("action","bp_attachments_make_directory"),d.append("object",s),d.append("object_item",o),c&&d.append("status",c),F(l,"/")!==c+"/"+s+"/"+o){let e=l;"private"===c&&(e=l.replace("/private","")),d.append("parent_dir",e)}n=!1;try{r=yield q("/buddypress/v1/attachments",d),yield{type:"UPLOAD_END",uploading:n,file:a},r.uploaded=!0;const e=i.getCurrentDirectoryObject(),t=X(r,e.id);return yield Q(t),te(r)}catch(e){return r={id:P(),name:a.name,error:e.message,uploaded:!1},yield{type:"UPLOAD_END",uploading:n,file:a},re(r)}}const ie=async function(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const a=await e.json().then((e=>(e.forEach((e=>{if(e.parent=n,"inode/directory"===e.mime_type){const r=X(e,n);j(t).addItemTree(r)}})),e)));r||n||K(a),j(t).getMedia(a,r,n)};function*se(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r="/buddypress/v1/attachments";let n="",a="";e.context||(e.context=x(t).getRequestsContext()),e.directory&&e.path&&(e.directory=G(e.path,"/")+"/"+e.directory),e.parent&&(a=e.parent,delete e.parent),delete e.path;const i=yield H(k(r,e),!1);return n=C(i,["headers","get"])?i.headers.get("X-BP-Attachments-Relative-Path"):get(i,["headers","X-BP-Attachments-Relative-Path"],""),ie(i,n,a)}function oe(e){return{type:"REMOVE_MEDIUM",id:e}}function*ce(e){const r=x(t).getRelativePath();let n;try{return n=yield V("/buddypress/v1/attachments/"+e.id+"/",r),"inode/directory"===n.previous.mime_type&&(yield Z(n.previous.id)),oe(n.previous.id)}catch(t){return e.error=t.message,re(e)}}function le(e){return{type:L.REMOVE_ERROR,errorID:e}}var de={};e(de,"getLoggedInUser",(function(){return pe})),e(de,"getMedia",(function(){return me}));const{filter:ue}=lodash;function*pe(){const e=yield H("/buddypress/v1/members/me?context=edit",!0);yield W(e)}function*me(){const e="/buddypress/v1/attachments?context="+(()=>{const{isAdminScreen:e}=window.bpAttachmentsMediaLibrarySettings||{};return e&&!0===e?"edit":"view"})(),t=yield H(e,!0);K(t),yield Y(t,"")}const{reject:ye}=lodash,he={user:{},tree:[],currentDirectory:"",files:[],relativePath:"",uploads:[],errors:[],uploading:!1,ended:!1,isSelectable:!1,isGrid:!0,settings:{},formState:{}};var be=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L.SET_SETTINGS:return{...e,settings:t.settings};case L.GET_LOGGED_IN_USER:return{...e,user:t.user};case L.GET_MEDIA:return{...e,files:t.files,relativePath:t.relativePath,currentDirectory:t.currentDirectory};case L.FILL_TREE:return{...e,tree:[...ye(e.tree,["id",t.item.id]),t.item]};case L.PURGE_TREE:return{...e,tree:ye(e.tree,["id",t.itemId])};case L.UPDATE_FORM_STATE:return{...e,formState:t.params};case L.ADD_MEDIUM:return{...e,files:[...ye(e.files,["id",t.file.id]),t.file]};case L.UPLOAD_START:return{...e,uploading:t.uploading,uploads:[...e.uploads,t.file]};case L.ADD_ERROR:return{...e,errors:[...e.errors,t.error]};case L.REMOVE_ERROR:return{...e,errors:ye(e.errors,["id",t.errorID])};case L.UPLOAD_END:return{...e,uploading:t.uploading,uploads:ye(e.uploads,(e=>e.name===t.file.name)),ended:!0};case L.RESET_UPLOADS:return{...e,uploading:!1,uploads:[],errors:[],ended:!1};case L.TOGGLE_SELECTABLE:return{...e,isSelectable:t.isSelectable};case L.TOGGLE_MEDIA_SELECTION:return{...e,files:e.files.map((e=>(("all"===t.ids[0]&&!t.isSelected||-1!==t.ids.indexOf(e.id))&&(e.selected=t.isSelected),e)))};case L.SWITCH_DISPLAY_MODE:return{...e,isGrid:t.isGrid};case L.REMOVE_MEDIUM:return{...e,files:[...ye(e.files,["id",t.id])]}}return e};const{apiFetch:Ee}=wp,fe={FETCH_FROM_API(e){let{path:t,parse:r}=e;return Ee({path:t,parse:r})},CREATE_FROM_API(e){let{path:t,data:r}=e;return Ee({path:t,method:"POST",body:r})},DELETE_FROM_API(e){let{path:t,relativePath:r}=e;return Ee({path:t,method:"DELETE",data:{relative_path:r}})}},{data:{registerStore:ge}}=wp;ge(t,{reducer:be,actions:w,selectors:r,controls:fe,resolvers:de});const _e=t,{components:{Popover:De},data:{useDispatch:ve,useSelect:Te},element:{createElement:Se,Fragment:Me,useState:Re},i18n:{__:Ae}}=wp;var Oe=e=>{let{settings:t}=e;const{updateFormState:r}=ve(_e),n=Te((e=>e(_e).getCurrentDirectoryObject()),[]),[a,i]=Re(!1),s=!0===a?"split-button is-open":"split-button",o=!0===a?"dashicons dashicons-arrow-up-alt2":"dashicons dashicons-arrow-down-alt2",c=!0!==n.readonly,{allowedExtByMediaList:l}=t,d=e=>(e.preventDefault(),r({parentDirectory:n.id,action:"upload"}));let u=[];n.type&&-1!==["album","audio_playlist","video_playlist"].indexOf(n.type)||(u=[{id:"folder",text:Ae("Add new directory","bp-attachments")}],l&&"private"!==n.visibility&&Object.keys(l).forEach((e=>{"album"===e?u.push({id:"album",text:Ae("Add new photo album","bp-attachments")}):"audio_playlist"===e?u.push({id:"audio_playlist",text:Ae("Add new audio playlist","bp-attachments")}):"video_playlist"===e&&u.push({id:"video_playlist",text:Ae("Add new video playlist","bp-attachments")})})));const p=u.map((e=>Se("li",{key:"type-"+e.id},Se("a",{href:"#new-bp-media-directory",className:"button-link directory-button split-button-option",onClick:t=>((e,t)=>(e.preventDefault(),r({parentDirectory:n.id,action:"createDirectory",directoryType:t})))(t,e.id)},e.text))));return Se(Me,null,Se("h1",{className:"wp-heading-inline"},Ae("Community Media Library","bp-attachments")),!!c&&Se("div",{className:s},Se("div",{className:"split-button-head"},Se("a",{href:"#new-bp-media-upload",className:"button split-button-primary","aria-live":"polite",onClick:e=>d(e)},Ae("Add new","bp-attachments")),Se("button",{type:"button",className:"split-button-toggle","aria-haspopup":"true","aria-expanded":a,onClick:()=>i(!a)},Se("i",{className:o}),Se("span",{className:"screen-reader-text"},Ae("More actions","bp-attachments")),a&&Se(De,{noArrow:!1,onFocusOutside:()=>i(!a)},Se("ul",{className:"split-button-body"},Se("li",null,Se("a",{href:"#new-bp-media-upload",className:"button-link media-button split-button-option",onClick:e=>d(e)},Ae("Upload media","bp-attachments"))),p))))),Se("hr",{className:"wp-header-end"}))};const{components:{DropZone:Ie,FormFileUpload:Ne},data:{useDispatch:we,useSelect:Le},element:{createElement:Pe},i18n:{__:Ce,sprintf:Fe}}=wp;var Ge=e=>{let{settings:t}=e;const{maxUploadFileSize:r,allowedExtTypes:n,allowedExtByMediaList:a}=t,{updateFormState:i,createMedium:o}=we(_e),{formState:c,currentDirectoryObject:l}=Le((e=>{const t=e(_e);return{formState:t.getFormState(),currentDirectoryObject:t.getCurrentDirectoryObject()}}),[]),d=()=>(c.action="",i(c)),u=e=>{let t;t=e.currentTarget&&e.currentTarget.files?[...e.currentTarget.files]:e,t.forEach((e=>{o(e)})),d()};if(!c.action||"upload"!==c.action)return null;let p=n;return l.type&&-1!==["album","audio_playlist","video_playlist"].indexOf(l.type)&&(p=a[l.type]),Pe("div",{className:"uploader-container enabled"},Pe(Ie,{label:Ce("Drop your files here.","bp-attachments"),onFilesDrop:e=>u(e),className:"uploader-inline"}),Pe("button",{className:"close dashicons dashicons-no",onClick:e=>(e=>{e.preventDefault(),d()})(e)},Pe("span",{className:"screen-reader-text"},Ce("Close the upload panel","bp-attachments"))),Pe("div",{className:"dropzone-label"},Pe("h2",{className:"upload-instructions drop-instructions"},Ce("Drop files to upload","bp-attachments")),Pe("p",{className:"upload-instructions drop-instructions"},Ce("or","bp-attachments")),Pe(Ne,{onChange:e=>u(e),multiple:!0,accept:p,className:"browser button button-hero"},Ce("Select Files","bp-attachments"))),Pe("div",{className:"upload-restrictions"},Pe("p",null,Fe(Ce("Maximum upload file size: %s.","bp-attachments"),s(r)))))};const{components:{Button:Ue,TextControl:je},data:{useDispatch:xe,useSelect:ke},element:{createElement:Be,useState:He},i18n:{__:qe}}=wp;var Ve=()=>{const[e,t]=He(""),{updateFormState:r,createDirectory:n}=xe(_e),a=ke((e=>e(_e).getFormState()),[]),i=()=>(a.action="",a.directoryType="",r(a));if(!a.action||"createDirectory"!==a.action)return null;let s=qe("Create a new directory","bp-attachments"),o=qe("Type a name for your directory","bp-attachments"),c=qe("Save directory","bp-attachments");return"album"===a.directoryType?(s=qe("Create a new photo album","bp-attachments"),o=qe("Type a name for your photo album","bp-attachments"),c=qe("Save photo album","bp-attachments")):"audio_playlist"===a.directoryType?(s=qe("Create a new audio playlist","bp-attachments"),o=qe("Type a name for your audio playlist","bp-attachments"),c=qe("Save audio playlist","bp-attachments")):"video_playlist"===a.directoryType&&(s=qe("Create a new video playlist","bp-attachments"),o=qe("Type a name for your video playlist","bp-attachments"),c=qe("Save video playlist","bp-attachments")),Be("form",{id:"bp-media-directory-form",className:"directory-creator-container enabled"},Be("button",{className:"close dashicons dashicons-no",onClick:e=>(e=>{e.preventDefault(),i()})(e)},Be("span",{className:"screen-reader-text"},qe("Close the Create directory form","bp-attachments"))),Be("h2",null,s),Be(je,{label:o,value:e,onChange:e=>t(e)}),Be(Ue,{variant:"primary",onClick:r=>(r=>{r.preventDefault();const s={directoryName:e,directoryType:a.directoryType};n(s),t(""),i()})(r)},c))};const{find:$e,reverse:We}=lodash,{components:{Button:Ye,TreeSelect:ze},element:{createElement:Xe,useState:Ke},data:{useDispatch:Qe,useSelect:Ze},hooks:{applyFilters:Je},i18n:{__:et}}=wp;var tt=e=>{let{gridDisplay:t,tree:r}=e;const{switchDisplayMode:n,requestMedia:a,toggleSelectable:s,toggleMediaSelection:o,deleteMedium:c}=Qe(_e),{user:l,currentDirectory:d,currentDirectoryObject:u,flatTree:p,isSelectable:m,selectedMedia:y}=Ze((e=>{const t=e(_e);return{user:t.getLoggedInUser(),currentDirectory:t.getCurrentDirectory(),currentDirectoryObject:t.getCurrentDirectoryObject(),flatTree:t.getFlatTree(),isSelectable:t.isSelectable(),selectedMedia:t.selectedMedia()}}),[]),[h,b]=Ke(d),E=!0!==u.readonly,f=m&&0!==y.length;d!==h&&b(d);const g=(e,t)=>{e.preventDefault(),n(t)};return Xe("div",{className:"media-toolbar wp-filter"},Xe("div",{className:"media-toolbar-secondary"},!m&&Xe("div",{className:"view-switch media-grid-view-switch"},Xe("a",{href:"#view-list",onClick:e=>g(e,!1),className:t?"view-list":"view-list current"},Xe("span",{className:"screen-reader-text"},et("Display list","bp-attachments"))),Xe("a",{href:"#view-grid",onClick:e=>g(e,!0),className:t?"view-grid current":"view-grid"},Xe("span",{className:"screen-reader-text"},et("Display grid","bp-attachments")))),E&&Xe(Ye,{variant:"secondary",className:"media-button select-mode-toggle-button",onClick:e=>(e=>{e.preventDefault();const t=!m;return t||o(["all"],t),s(t)})(e)},et(m?"Cancel Selection":"Select","bp-attachments")),E&&f&&Xe(Ye,{variant:"primary",className:"media-button delete-selected-button",onClick:e=>(e.preventDefault(),y.forEach((e=>{c(e)})),s(!1))},et("Delete selection","bp-attachments"))),!!r.length&&Xe("div",{className:"media-toolbar-primary"},Xe(ze,{noOptionLabel:et("Home","bp-attachments"),onChange:e=>(e=>{b(e);const t=$e(p,{id:e});let r={};if(t){if(r.directory=t.slug,r.parent=t.id,t.parent&&t.object){let e=We(i(p,t.parent).map((e=>e.slug)));if("members"===t.object){const r=e.indexOf("member");-1!==r&&e.splice(r,1),e.length&&e.splice(1,0,t.object,l.id)}else e=Je("buddypress.Attachments.toolbarTreeSelect.pathArray",e,t,l.id);r.path="/"+e.join("/")}t.object&&(r.object=t.object)}return a(r)})(e),selectedId:h,tree:r})))};const{template:rt}=lodash;const{components:{Button:nt,TextareaControl:at,TextControl:it},element:{createElement:st,useState:ot},i18n:{__:ct}}=wp;var lt=e=>{let{medium:t}=e;const{title:r,description:n,vignette:a,icon:i,links:{view:s,download:o}}=t,[c,l]=ot({title:r,description:n}),d=r===c.title&&n===c.description;return st("div",{className:"bp-attachment-edit-item"},st("div",{className:"bp-attachment-edit-item__preview"},st("h3",{className:"bp-attachment-edit-item__preview_title"},c.title),st("div",{className:"bp-attachment-edit-item__preview_vignette"},st("p",null,c.description),a&&st("img",{src:a,className:"bp-attachment-medium-vignette"}),!a&&st("img",{src:i,className:"bp-attachment-medium-icon"}))),st("div",{className:"bp-attachment-edit-item__form"},st("h3",null,ct("Editable media properties","bp-attachments")),st("p",{className:"description"},ct("Use the below fields to edit media properties.","bp-attachments")),st(it,{label:ct("Title","bp-attachments"),value:c.title,onChange:e=>l({...c,title:e}),help:ct("Change the title of your medium to something more descriptive then its file name.","bp-attachments")}),st(at,{label:ct("Description","bp-attachments"),value:c.description,onChange:e=>l({...c,description:e}),help:ct("Add or edit the description of your medium to tell your story about it.","bp-attachments")}),st("div",{className:"bp-attachment-edit-item__form-actions"},st(nt,{variant:"primary",disabled:d,onClick:e=>(e.preventDefault(),void console.log(c))},ct("Save your edits","bp-attachment")),st(nt,{variant:"tertiary",disabled:d,onClick:e=>(e.preventDefault(),void l({...c,title:r,description:n}))},ct("Cancel","bp-attachment")))))};const{element:{createElement:dt,Fragment:ut,useState:pt},components:{Modal:mt},i18n:{__:yt,sprintf:ht},data:{useSelect:bt,useDispatch:Et}}=wp;var ft=e=>{const t=(r="bp-attachments-media-item",rt(document.querySelector("#tmpl-"+r).innerHTML,{evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"}));var r;const{name:n,medium:a,selected:i}=e,{toggleMediaSelection:s,requestMedia:o}=Et(_e),[c,l]=pt(!1),[d,u]=pt(i),{getRelativePath:p,isSelectable:m}=bt((e=>{const t=e(_e);return{getRelativePath:t.getRelativePath(),isSelectable:t.isSelectable()}}),[]);m||i||!d||u(!1);return dt(ut,null,dt("div",{className:d?"media-item selected":"media-item",dangerouslySetInnerHTML:{__html:t(e)},role:"checkbox",onClick:()=>(()=>{const{mimeType:t,name:r,isSelectable:n,id:a,object:i}=e;return n?(u(!d),s([a],!d)):"inode/directory"===t?o({directory:r,path:p,object:i,parent:a}):void l(!0)})()}),c&&dt(mt,{title:ht(yt("Edit %s","bp-attachments"),n),onRequestClose:()=>l(!1)},dt(lt,{medium:a})))};const{components:{Animate:gt,Dashicon:_t,Notice:Dt},element:{createElement:vt,Fragment:Tt},i18n:{__:St,sprintf:Mt},data:{useSelect:Rt,useDispatch:At}}=wp;var Ot=()=>{const{uploads:e,errors:t}=Rt((e=>{const t=e(_e);return{uploads:t.getUploads(),errors:t.getErrors()}}),[]),{removeMediumError:r}=At(_e);let n=[];t&&t.length&&(n=t.map((e=>vt(Dt,{key:"error-"+e.id,status:"error",onRemove:()=>{return t=e.id,r(t);var t},isDismissible:!0},vt("p",null,vt(_t,{icon:"warning"}),Mt(St("« %1$s » wasn‘t added to the media library. %2$s","bp-attachments"),e.name,e.error))))));let a=null;const i=e&&e.length?e.length:0;if(i){let e=St("Uploading the media, please wait.","bp-attachments");i>1&&(e=Mt(St("Uploading %d media, please wait.","bp-attachments"),i)),a=vt("div",{className:"chargement-de-documents"},vt(gt,{type:"loading"},(t=>{let{className:r}=t;return vt(Dt,{status:"warning",isDismissible:!1},vt("p",{className:r},vt(_t,{icon:"update"}),e))})))}return vt("div",{className:"bp-attachments-notices"},a,n)};const{element:{createElement:It,Fragment:Nt},i18n:{__:wt},data:{useSelect:Lt,useDispatch:Pt}}=wp;var Ct=e=>{let{gridDisplay:t,tree:r}=e;const{items:n,isSelectable:a}=Lt((e=>{const t=e(_e);return{items:t.getMedia(),isSelectable:t.isSelectable()}}),[]);let i=null;return n.length&&(i=n.map((e=>It(ft,{key:"media-item-"+e.id,id:e.id,name:e.name,title:e.title,mediaType:e.media_type,mimeType:e.mime_type,icon:e.icon,vignette:e.vignette,orientation:e.orientation,isSelected:e.selected||!1,object:e.object||"members",isSelectable:a,tree:r,medium:e})))),It("main",{className:"bp-user-media"},It(Ot,null),It("div",{className:a?"media-items mode-select":"media-items"},i,!n.length&&It("p",{className:"no-media"},wt("No community media items found.","bp-attachments"))))};const{domReady:Ft,element:{createElement:Gt,render:Ut,Fragment:jt},i18n:{__:xt},data:{useSelect:kt,useDispatch:Bt}}=wp,Ht=e=>{let{settings:t}=e;const{isGrid:r,globalSettings:n,tree:a}=kt((e=>{const t=e(_e);return{isGrid:t.isGridDisplayMode(),globalSettings:t.getSettings(),tree:t.getTree()}}),[]);if(!Object.keys(n).length){const{setSettings:e}=Bt(_e);e(t)}return Gt(jt,null,Gt(Oe,{settings:n}),Gt(Ge,{settings:n}),Gt(Ve,null),Gt(tt,{gridDisplay:r,tree:a}),Gt(Ct,{gridDisplay:r,tree:a}))};Ft((function(){const e=window.bpAttachmentsMediaLibrarySettings||{};Ut(Gt(Ht,{settings:e}),document.querySelector("#bp-media-library"))}))}();
//# sourceMappingURL=index.js.map
